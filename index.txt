# 带备注的 JSON 重排版工具
![界面](http://upyun.luckly-mjw.cn/Assets/json-remark-parse/01.png)
### [在线地址](http://blog.luckly-mjw.cn/tool-show/json-remark-parse/index.html)

### 研发背景
- 工具欠缺，笔者寻找全网，未发现类似功能的工具。
- 在使用 YAPI 等接口文档工具时，未配备有重排版功能，需要手动调整缩进。繁琐且无意义。
    - 网上有很多 JSON 格式化工具，但均仅使用 JSON.parse()，JSON.stringify() 对内容进行解析和排班，但由于 JSON 本身是无法备注的。导致解析出错。
- 常会将业务代码，拷贝到 YAPI 中。但需要手动删除 value 值，以及逐个添加双引号「""」。繁琐且无意义。
- 结合以上原因，开发了本工具。

### 思路
*只是基础运用，并不高大上*
- 利用 eval() 将源码字符串转化为对象。
    - 不可用 JSON.parse()，因为源码字符串是携带备注信息的```// 备注信息```，不是标准 JSON 数据。不可直接解析。
    - 通过挂载在 window 上的全局变量「window._originStr」传递到项目中。
    - ```eval(`window._originStr = ${originStr}`)```。
- 获取「源码字符串」的每一行```originStrLine = originStr.split('\n')```。
    - 并通过正则获取每一行的备注信息，并以对象形式「remarkObj」保存。如```"pageIndex": "1", // 第几页```，则保存为```"pageIndex": "// 第几页"```。
- 获取去除备注信息后的「JSON 对象字符串」的每一行```jsonStrLine = jsonStr.split('\n') ```。
- 遍历 jsonStrLine 每一行，并通过 key 寻找「remarkObj」是都有对应的备注信息，有则重新添加进去。
- 将 jsonStrLine 组合成 单条字符串输出。
- 总结
    - 先找出备注信息。
    - 格式化。
    - 将备注进行添加回去。

### 使用说明
- 【2缩进】将 json 字符串的缩进修改为 2 个空格。（默认 4 个控制）
- 【去值】去除 JSON 的值，只保留 key。常用于复制项目代码到 YAPI 等接口说明文档时，清除业务值。(注意，只会删除字符串的值，非字符串值，如数值，布尔值等保留)
- 【复制】复制重排版后的 JSON 字符串